<!-- Products Grid -->
<div class="row product-grid-4">
    <% if (products && products.length > 0) { %>
        <% products.forEach(product => { %>
            <div class="col-lg-3 col-md-4 col-12 col-sm-6 product-item">
                <div class="product-cart-wrap mb-30" data-product-name="<%= product.productName.toLowerCase() %>" data-product-description="<%= product.description.toLowerCase() %>" data-product-brand="<%= product.brand.toLowerCase() %>" data-product-price="<%= Number(product.salePrice) %>">
                    <div class="product-img-action-wrap">
                        <div class="product-img product-img-zoom">
                            <a href="/productDetails?id=<%= product._id %>">
                                <img class="default-img" 
                                    src="<%= product.productImage && product.productImage.length > 0 ? `/uploads/re-image/${product.productImage[0]}` : '/uploads/re-image/default.jpeg' %>"
                                    alt="<%= product.productName %>"
                                    loading="lazy">
                            </a>
                        </div>
                        <div class="product-action-1">
                            <button class="action-btn hover-up wishlist-btn" onclick="toggleWishlist(this, '<%= product._id %>')" data-product-id="<%= product._id %>">
                                <% if (product.isInWishlist) { %>
                                    <i class="fas fa-heart"></i>
                                <% } else { %>
                                    <i class="far fa-heart"></i>
                                <% } %>
                            </button>
                        </div>
                    </div>
                    <div class="product-content-wrap">
                        <h2><a href="/productDetails?id=<%= product._id %>"><%= product.productName %></a></h2>
                        <div class="rating-result" title="90%">
                            <span>
                                <span></span>
                            </span>
                        </div>
                        <div class="product-price">
                            <span>₹<%= product.salePrice %></span>
                            <% if (product.regularPrice > product.salePrice) { %>
                                <span class="old-price">₹<%= product.regularPrice %></span>
                            <% } %>
                        </div>
                        <% if (product.effectiveOffer > 0) { %>
                            <div class="product-badges product-badges-position product-badges-mrg">
                                <span class="hot"><%= product.effectiveOffer %>% OFF</span>
                            </div>
                        <% } %>
                        <div class="product-action-1 show">
                            <% if (product.quantity > 0) { %>
                                <a aria-label="Add To Cart" class="action-btn hover-up" href="#" onclick="event.preventDefault(); addToCart('<%= product._id %>')">
                                    <i class="fi-rs-shopping-bag-add"></i>
                                </a>
                            <% } else { %>
                                <a aria-label="Out of Stock" class="action-btn hover-up out-of-stock" href="#" onclick="event.preventDefault(); showOutOfStockMessage()">
                                    <i class="fi-rs-shopping-bag-add"></i>
                                </a>
                            <% } %>
                        </div>
                    </div>
                </div>
            </div>
        <% }); %>
    <% } else { %>
        <div class="col-12 text-center">
            <p>No products found matching your criteria.</p>
        </div>
    <% } %>
</div>
